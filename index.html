<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Household Store Premium Demo</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  body { margin:0; font-family:"Segoe UI",sans-serif; background:#f5f7fa; color:#333; overflow-x:hidden; }
  header { background:linear-gradient(90deg,#4f46e5,#6d28d9); color:white; padding:20px; display:flex; justify-content:space-between; align-items:center; }
  header h1 { margin:0; font-size:1.5rem; }
  .cart-btn, #google_translate_element { margin-left:10px; background:white; color:#4f46e5; border:none; padding:10px 15px; border-radius:25px; font-weight:bold; cursor:pointer; transition:0.3s; }
  .cart-btn:hover, #google_translate_element:hover { background:#ddd; }
  .products { display:grid; grid-template-columns:repeat(auto-fit,minmax(250px,1fr)); gap:20px; padding:20px; }
  .product { background:white; border-radius:15px; box-shadow:0 4px 15px rgba(0,0,0,0.1); overflow:hidden; transition:transform 0.2s; position:relative; }
  .product:hover { transform:translateY(-5px); }
  .product img { width:100%; height:200px; object-fit:cover; }
  .product h3 { margin:10px; font-size:1.2rem; }
  .product p { margin:5px 10px; color:#555; }
  .product button { margin:10px; padding:10px; width:calc(100% - 20px); border:none; background:#4f46e5; color:white; border-radius:10px; cursor:pointer; transition:0.3s; }
  .product button:hover { background:#6d28d9; }
  #cartModal { display:none; position:fixed; top:0; left:0; right:0; bottom:0; background:rgba(0,0,0,0.6); justify-content:center; align-items:center; z-index:1000; }
  #cartContent { background:white; padding:20px; border-radius:15px; width:90%; max-width:500px; max-height:80vh; overflow-y:auto; }
  #cartContent h2 { margin-top:0; }
  .cart-item { display:flex; justify-content:space-between; margin:10px 0; padding:10px; border-bottom:1px solid #ddd; }
  .checkout-btn { margin-top:20px; width:100%; padding:12px; background:#16a34a; color:white; border:none; border-radius:10px; cursor:pointer; font-size:1rem; }
  .checkout-btn:hover { background:#15803d; }
  .flying-item { position:absolute; width:50px; height:50px; border-radius:10px; z-index:9999; pointer-events:none; transition: transform 1s ease-in-out; }
</style>
</head>
<body>

<header>
  <h1>üè° Household Store</h1>
  <div style="display:flex; align-items:center;">
    <div id="google_translate_element"></div>
    <button class="cart-btn" onclick="openCart()">üõí Cart (<span id="cart-count">0</span>)</button>
  </div>
</header>

<main class="products" id="product-list"></main>

<div id="cartModal">
  <div id="cartContent">
    <h2>Your Cart</h2>
    <div id="cart-items"></div>
    <h3>Total: $<span id="cart-total">0</span></h3>
    <button class="checkout-btn" onclick="checkoutCOD()">Cash on Delivery</button>
    <br><br>
    <button onclick="closeCart()">Close</button>
  </div>
</div>

<script type="module">
  let products = [];
  let cart = [];

  // Dynamic CSV loader
  async function loadProductsFromCSV() {
    const response = await fetch('products.csv');
    const text = await response.text();
    const lines = text.trim().split('\n');
    const headers = lines.shift().split(',');
    products = lines.map(line => {
      const data = line.split(',');
      const obj = {};
      headers.forEach((h,i)=>obj[h]=isNaN(data[i])?data[i]:Number(data[i]));
      obj.qty=0;
      return obj;
    });
    renderProducts();
  }

  function renderProducts() {
    const container = document.getElementById("product-list");
    container.innerHTML = products.map(p => `
      <div class="product">
        <img src="${p.img}" alt="${p.name}">
        <h3>${p.name}</h3>
        <p>${p.description || ""}</p>
        <p>$${p.price}</p>
        <button onclick="flyToCart(${p.id})">Add to Cart</button>
      </div>
    `).join('');
  }

  function updateCart() {
    document.getElementById("cart-count").textContent = cart.reduce((a,b)=>a+b.qty,0);
    document.getElementById("cart-items").innerHTML = cart.map(i=>`
      <div class="cart-item">
        <span>${i.name} (x${i.qty})</span>
        <span>$${i.price*i.qty}</span>
      </div>`).join('');
    document.getElementById("cart-total").textContent = cart.reduce((a,b)=>a+b.price*b.qty,0);
  }

  function openCart(){ document.getElementById("cartModal").style.display="flex"; }
  function closeCart(){ document.getElementById("cartModal").style.display="none"; }

  function checkoutCOD(){
    if(cart.length===0){ alert("Cart is empty!"); return; }
    alert("Order placed! (Demo Mode)");
    cart=[];
    updateCart();
    closeCart();
  }

  // Flying animation (snake-like path)
  function flyToCart(id){
    const product = products.find(p=>p.id===id);
    const fly = document.createElement('img');
    fly.src = product.img;
    fly.className = 'flying-item';
    document.body.appendChild(fly);

    const startX = Math.random()*window.innerWidth*0.5;
    const startY = window.innerHeight - 100;
    fly.style.transform = `translate(${startX}px, ${startY}px) scale(0.5)`;
    
    // First move to top-left slowly
    setTimeout(()=>fly.style.transition = 'transform 2s ease-in-out',100);
    setTimeout(()=>fly.style.transform = `translate(50px, 50px) scale(0.5)`,200);

    // Then move quickly to cart
    setTimeout(()=>{
      const cartBtn = document.querySelector('.cart-btn');
      const rect = cartBtn.getBoundingClientRect();
      fly.style.transition = 'transform 1s ease-in-out';
      fly.style.transform = `translate(${rect.left}px, ${rect.top}px) scale(0.3)`;
    },2200);

    setTimeout(()=>{
      document.body.removeChild(fly);
      const item = cart.find(i=>i.id===id);
      if(item) item.qty++;
      else cart.push({...product, qty:1});
      updateCart();
    },3400);
  }

  // Google Translate
  function googleTranslateElementInit() {
    new google.translate.TranslateElement({
      pageLanguage:'en',
      includedLanguages:'en,hi,es,fr,de,ja,zh-CN',
      layout: google.translate.TranslateElement.InlineLayout.SIMPLE
    }, 'google_translate_element');
  }
</script>

<script type="text/javascript" src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
<script>
  loadProductsFromCSV();
</script>

</body>
</html>
